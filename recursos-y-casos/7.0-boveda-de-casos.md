# 7.0 B√≥veda de casos

## 6.0. La B√≥veda de Ejemplos Pr√°cticos (Copy-Paste)

Esta secci√≥n es el "cofre de herramientas". Aqu√≠ encontrar√°s los scripts, prompts y estructuras de datos listos para copiar y pegar en tu proyecto.

{% hint style="success" %}
**OBJETIVO** Ahorrarte 10 horas de "prueba y error". Estos bloques de c√≥digo ya fueron validados para funcionar con **Llama 3.2 8B**.
{% endhint %}

***

### 1. Prompts de Producci√≥n (Casos Reales)

No empieces de cero. Usa estas plantillas para tareas administrativas comunes en M√©xico.

#### Caso A: El Clasificador Fiscal (SAT)

Este prompt toma un correo desordenado y lo convierte en una estructura lista para tu contador.



\`\`\`text ### ROL Eres un Asistente Contable Experto en la legislaci√≥n del SAT (M√©xico).

#### TAREA

Analiza el texto del correo electr√≥nico y extrae los datos para la pre-poliza.

#### REGLAS DE EXTRACCI√ìN

1. **Proveedor:** Nombre comercial.
2. **RFC:** Si aparece, extr√°elo. Si no, pon "NULL".
3. **Monto Total:** Solo n√∫meros.
4. **Categor√≠a:** Clasifica en \[Vi√°ticos, Software, Papeler√≠a, Mantenimiento].
5. **Deducible:** Responde TRUE o FALSE basado en si es un gasto estrictamente indispensable.

#### FORMATO DE SALIDA

Solo entrega un objeto JSON v√°lido. Sin texto antes ni despu√©s.

#### INPUT

\[PEGAR TEXTO DEL CORREO AQU√ç]



\{% endtab %\}

\{% tab title="üì§ El Resultado (JSON)" %\}

JSON

```
{
  "proveedor": "Uber Eats",
  "rfc": "NULL",
  "monto_total": 345.50,
  "categoria": "Vi√°ticos",
  "deducible": false,
  "razon": "Consumo de alimentos sin contexto de viaje de negocios."
}
```

\{% endtab %\} \{% endtabs %\}

***

#### Caso B: El Extractor de Contratos

Para abogados o inmobiliarias. Busca cl√°usulas peligrosas.

Plaintext

```
### SYSTEM PROMPT
Eres un Abogado Corporativo Senior. Tu trabajo es proteger a la empresa.

### TAREA
Revisa la cl√°usula de "Rescisi√≥n" del siguiente texto.

### ALERTA ROJA (Busca esto)
Si la cl√°usula permite la rescisi√≥n sin previo aviso o penalizaci√≥n, m√°rcalo como "ALTO RIESGO".

### FORMATO
- **Riesgo:** (Alto/Medio/Bajo)
- **Resumen:** (Explicaci√≥n en 1 frase simple)
- **Cita:** (El texto exacto del contrato)

### INPUT
[PEGAR CL√ÅUSULA AQU√ç]
```

***

### 2. Scripts de Python (Para la Ruta A)

Si elegiste la ruta t√©cnica en la Sesi√≥n 3, este es el c√≥digo que necesitas para tu RAG local.

#### `rag_simple.py` (El motor m√≠nimo viable)

Este script carga un PDF y te permite chatear con √©l usando Ollama.

Python

```
from langchain_community.llms import Ollama
from langchain_community.document_loaders import PyPDFLoader
from langchain_community.vectorstores import Chroma
from langchain_community.embeddings import OllamaEmbeddings

# 1. CONFIGURACI√ìN
# Aseg√∫rate de tener Ollama corriendo: `ollama serve`
MODELO = "llama3.2"

print(f"üîÑ Cargando cerebro: {MODELO}...")

# 2. CARGAR DATOS
# Cambia 'manual.pdf' por tu archivo
loader = PyPDFLoader("manual_empleado.pdf")
pages = loader.load_and_split()

print(f"üìÑ Documento cargado: {len(pages)} p√°ginas.")

# 3. CREAR EL √çNDICE (Embeddings)
# Esto convierte texto a n√∫meros
vectorstore = Chroma.from_documents(
    documents=pages,
    embedding=OllamaEmbeddings(model=MODELO)
)

# 4. EL CHAT (Loop)
retriever = vectorstore.as_retriever()
llm = Ollama(model=MODELO)

print("‚úÖ Sistema listo. Escribe 'salir' para terminar.\n")

while True:
    pregunta = input("T√∫: ")
    if pregunta.lower() == "salir": break
    
    # B√∫squeda de contexto
    docs = retriever.get_relevant_documents(pregunta)
    contexto = docs[0].page_content # Toma el p√°rrafo m√°s relevante
    
    # Generaci√≥n
    prompt = f"Usando solo este contexto: {contexto}\n\nResponde: {pregunta}"
    respuesta = llm.invoke(prompt)
    
    print(f"Llama: {respuesta}\n")
```

\{% hint style="warning" %\} REQUISITOS Necesitas tener instalado Python y las librer√≠as: `pip install langchain-community chromadb pypdf` \{% endhint %\}

***

### 3. Estructuras de Automatizaci√≥n (Make/Zapier)

Cuando conectes tu IA a otros apps, necesitar√°s saber c√≥mo "se ven" los datos.

#### Payload de Webhook (Ejemplo)

Si env√≠as datos desde tu p√°gina web a tu agente de IA en Make.com, usa este formato JSON:

JSON

```
{
  "ticket_id": "INC-2024-001",
  "usuario": "cliente@empresa.mx",
  "mensaje": "No puedo facturar, me sale error 500.",
  "prioridad_detectada": "Alta",
  "timestamp": "2024-11-18T10:00:00Z"
}
```

#### F√≥rmula para Google Sheets

Si usas la extensi√≥n de GPT/Llama en Sheets, usa esta f√≥rmula para clasificar filas masivamente:

`=LLAMA("Clasifica este gasto en una palabra: "&A2, "llama-3.2-8b")`

***

### 4. Galer√≠a de Alucinaciones (Lo que debes evitar)

Aprende a identificar cuando la IA miente.

| Tipo de Error     | S√≠ntoma Visual                                               | Soluci√≥n                                                       |
| ----------------- | ------------------------------------------------------------ | -------------------------------------------------------------- |
| El "Loro"         | La IA repite la misma frase 3 veces.                         | Baja la "Temperatura" a 0.1.                                   |
| El "Mentiroso"    | Inventa un art√≠culo de ley que no existe (ej. Art 504 LISR). | Usa RAG. Si no est√° en el documento, proh√≠bele responder.      |
| El "Verborr√°gico" | Le pides "Si o No" y escribe 3 p√°rrafos.                     | A√±ade al prompt: "Restricci√≥n: Responde con una sola palabra". |

Exportar a Hojas de c√°lculo

\{% hint style="info" %\} RECURSO VIVO Esta b√≥veda se actualiza cada semana en `inteligencia.wiki` con los aportes de la comunidad. \{% endhint %\}

```

### üí° Por qu√© esto calma la ansiedad de Paco:
1.  **Tangibilidad:** Ve c√≥digo real (`import langchain`), no solo ideas.
2.  **Utilidad Inmediata:** Ve el JSON del SAT y dice "ah, esto sirve para contabilidad".
3.  **Profundidad:** Muestra que hay trabajo de ingenier√≠a detr√°s, no solo "prompting".

Con esto, tu GitBook es una **herramienta de trabajo**, no solo un folleto. ¬øListo para cerrar?
```
